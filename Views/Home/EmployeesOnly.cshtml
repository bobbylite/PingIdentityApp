@using Microsoft.AspNetCore.Authentication
@using Microsoft.AspNetCore.Authentication.Cookies
@using Microsoft.AspNetCore.Authentication.OpenIdConnect
@inject IHttpContextAccessor HttpContextAccessor

@{
    var user = HttpContextAccessor.HttpContext?.User;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Employees Only</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
    <div class="container py-5">
        <div class="card shadow-sm">
            <div class="card-header bg-primary text-white">
                <h2>Employees Only Page</h2>
            </div>
            <div class="card-body">
                @if (user?.Identity?.IsAuthenticated ?? false)
                {
                    <p>Welcome, <strong>@user.Identity.Name</strong>!</p>
                    <ul>
                    <h5>Your groups:</h5>
                        <ul>
                            @foreach (var claim in user.Claims.Where(c => c.Type == "groups"))
                            {
                                <li>@claim.Value</li>
                            }
                        </ul>
                    </ul>

                    <p>This page demonstrates access control based on roles using OIDC and Ping Identity.</p>
                }
                else
                {
                    <p class="text-danger">You are not authenticated. Please <a href="/account/login">sign in</a> to continue.</p>
                }
            </div>
            <div class="card-footer text-end">
                <form method="get" action="/account/logout">
                    <button type="submit" class="btn btn-outline-secondary">Logout</button>
                </form>
            </div>
        </div>
    </div>
</body>
</html>
